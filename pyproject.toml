[build-system]
requires = ["setuptools >= 60.0.0", "setuptools_scm[toml] >= 7.0.0", "wheel"]
build-backend = "setuptools.build_meta"


[project]
name = "jira"
authors = [{ name = "Ben Speakmon", email = "ben.speakmon@gmail.com" }]
maintainers = [{ name = "Sorin Sbarnea", email = "sorin.sbarnea@gmail.com" }]
description = "Python library for interacting with JIRA via REST APIs."
readme = "README.rst"
requires-python = ">=3.8"
license = { text = "BSD" }
classifiers = [
  "Development Status :: 5 - Production/Stable",
  "Environment :: Other Environment",
  "Intended Audience :: Developers",
  "Intended Audience :: Information Technology",
  "License :: OSI Approved :: BSD License",
  "Operating System :: OS Independent",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.8",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Topic :: Software Development :: Libraries :: Python Modules",
  "Topic :: Internet :: WWW/HTTP",
]
keywords = ["api", "atlassian", "jira", "rest", "web"]

dynamic = [
  "version", # setuptools_scm
]

dependencies = [
  "defusedxml",
  "packaging",
  "requests-oauthlib>=1.1.0",
  "requests>=2.10.0",
  "requests_toolbelt",
  "typing_extensions>=3.7.4.2",
]

[project.optional-dependencies]
cli = [ # CLI with jirashell
  "ipython>=4.0.0",
  "keyring",
]
docs = [ # Docs
  "Sphinx>=2.2.0",
  "sphinx_rtd_theme>=0.4.3",
]
opt = [ # optional
  "filemagic>=1.6",
  "PyJWT",
  "requests_jwt",
  "requests_kerberos",
]
async = [ # async
  "requests-futures>=0.9.7",
]
test = [
  "docutils>=0.12",
  "flaky",
  "MarkupSafe>=0.23",
  "oauthlib",
  "py >= 1.4",
  "pytest-cache",
  "pytest-cov",
  "pytest-instafail",
  "pytest-sugar",
  "pytest-timeout>=1.3.1",
  "pytest-xdist>=2.2",
  "pytest>=6.0.0",         # MIT
  "PyYAML>=5.1",           # MIT
  "requests_mock",         # Apache-2
  "requires.io",           # UNKNOWN!!!
  "tenacity",              # Apache-2
  "wheel>=0.24.0",         # MIT
  "xmlrunner>=1.7.7",      # LGPL
  "yanc>=0.3.3",           # GPL
]

[project.urls]
Bug-Tracker = "https://github.com/pycontribs/jira/issues"
Release-Management = "https://github.com/pycontribs/jira/projects"
CI-GitHub-Actions = "https://github.com/pycontribs/jira/actions"
Source-Code = "https://github.com/pycontribs/jira.git"
Documentation = "https://jira.readthedocs.io"
Forum = "https://community.atlassian.com/t5/tag/jira-python/tg-p?sort=recent"


[project.scripts]
jirashell = "jira.jirashell:main"

[options.package_data]
jira = "jira/py.typed"

# Setuptools config
# Equivalent to use_scm_version=True
[tool.setuptools_scm]

# Tool Config
[tool.isort]
profile = "black"
src_paths = ["jira", "tests"]


[tool.pytest.ini_options]
minversion = "6.0"
testpaths = ["tests"]
addopts = '''-p no:xdist --durations=10 --tb=long -rxX -v --color=yes
             --junitxml=build/results.xml
             --cov-report=xml --cov jira'''

# these are important for distributed testing, to speedup their execution we minimize what we sync
rsyncdirs = ". jira demo docs"
rsyncignore = ".git"

# pytest-timeout, delete_project on jira cloud takes >70s
timeout = 80

# avoid useless warnings related to coverage skips
filterwarnings = ["ignore::pytest.PytestWarning"]

markers = ["allow_on_cloud: opt in for the test to run on Jira Cloud"]


[tool.mypy]
python_version = 3.8
warn_unused_configs = true
namespace_packages = true
